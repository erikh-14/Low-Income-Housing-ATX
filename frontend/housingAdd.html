<!DOCTYPE html>

<!-- Sets the Source for the Javascript to run in the HTML file -->

<html lang="en">
<!-- References the Stylesheet for the CSS on the Login Page -->

<head>
    <script type="text/javascript" src="utilities.js"></script>
    <link rel="stylesheet" type="text/css" href="ziplocatorstyle.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
</head>
<style>
    input {
      text-align: center;
    }
    ::-webkit-input-placeholder {
    text-align: center;
  }
  :-moz-placeholder {
    text-align: center;
  }
</style>
<body>
    <title>Admin new hosuing </title>

    <center>
        <h1> ADDING NEW HOUSING</h1>
    </center>
    <button class="example_b" type="button"
        onclick="window.location.href = 'http://67.205.136.114/adminDash.html';">Back
        to Dashboard</button>
    <!-- Button Allows the Logout to end the Session and Return to the login page -->
    <button class="example_c" type="button"
        onclick="window.location.href = 'http://67.205.136.114/admin.html';">Logout</button>

    <br></br>

    <br></br>
    <div class="container">
        <div class="row">
            <div class="col-lg-10 col-xl-9 mx-auto">
                <div class="card card-signin flex-row my-5">
                    <div class="card-body">
                        <h5 class="card-title text-center">Please select from the following options</h5>

                        <form class="form-signin" name="myForm">
                            <div class="form-label-group">
                                <center>
                                    <label for = "address"><span>Project Name</span></label>
                                    <input type="text" id="projectName" name="projectName">
                                    <br>
                                    <label for = "address"><span>Address</span></label>
                                    <input type="text" id="address" name="address">
                                    <br>
                                    <label for="zCode"><span>ZIP Code</span></label>
                                    <select id="zCode" name="zip">
                                        <option value="78617">78617</option>
                                        <option value="78652">78652</option>
                                        <option value="78701">78701</option>
                                        <option value="78702">78702</option>
                                        <option value="78703">78703</option>
                                        <option value="78704">78704</option>
                                        <option value="78705">78705</option>
                                        <option value="78717">78717</option>
                                        <option value="78721">78721</option>
                                        <option value="78722">78722</option>
                                        <option value="78723">78723</option>
                                        <option value="78724">78724</option>
                                        <option value="78727">78727</option>
                                        <option value="78730">78730</option>
                                        <option value="78735">78735</option>
                                        <option value="78741">78741</option>
                                        <option value="78745">78745</option>
                                        <option value="78747">78747</option>
                                        <option value="78748">78748</option>
                                        <option value="78749">78749</option>
                                        <option value="78750">78750</option>
                                        <option value="78751">78751</option>
                                        <option value="78752">78752</option>
                                        <option value="78753">78753</option>
                                        <option value="78754">78754</option>
                                        <option value="78756">78756</option>
                                        <option value="78757">78757</option>
                                        <option value="78758">78758</option>
                                        <option value="78759">78759</option>

                                    </select>
                                    <br>
                                    <hr>
                                    <label for = "totalUnits"><span>Total Units</span></label>
                                    <input type="text" id="totalUnits" name="totalUnits">
                                    <br>
                                    <label for = "affordableUnits"><span>Total Affordable Units</span></label>
                                    <input type="text" id="affordableUnits" 
                                    name="affordableUnits">
                                    <br>
                                    <label for = "unitType"><span>Unit Type</span></label>
                                    <select id="unitType" name="unitType">
                                        <option value="ADU">ADU</option>
                                        <option value="Duplex">Duplex</option>
                                        <option value="FourPlex">FourPlex</option>
                                        <option value="Multifamily">Multifamily</option>
                                        <option value="Single Family">Single Family</option>
                                    </select>
                                    <br>
                                    <label for="status"><span>Status</span></label>
                                    <select id="status" name="status">
                                        <option value="Building Permit issued">Building Permit issued</option>
                                        <option value="Project Completed">Project Completed</option>
                                    </select>
                                    <br>
                                    <label for="hType"><span>Housing Type</span></label>
                                    <select id="hType" name="housingType">
                                        <option value="Residential Housing">Residential</option>
                                        <option value="Transitional Housing">Transitional</option>
                                        <option value="Senior Housing">Senior</option>
                                        <option value="Accessible Housing">Accessible</option>
                                        <option value="Student Housing">Student</option>
                                    </select>
                                    <br>
                                    <hr>
                                    <br>

                                    <label for="1 Person Household">1 Person Household income</label>
                                    <input type="text" id="1 Person Household" name="1 Person Household" placeholder="Your annual income">
                                    <br>

                                    <label for="2 Person Household">2 Person Household income</label>
                                    <input type="text" id="2 Person Household" name="2 Person Household" placeholder="Your annual income">
                                    <br>

                                    <label for="3 Person Household">3 Person Household income</label>
                                    <input type="text" id="3 Person Household" name="3 Person Household" placeholder="Your annual income">
                                    <br>

                                    <label for="4 Person Household">4 Person Household income</label>
                                    <input type="text" id="4 Person Household" name="4 Person Household" placeholder="Your annual income">
                                    <br>

                                    <label for="5 Person Household">5 Person Household income</label>
                                    <input type="text" id="5 Person Household" name="5 Person Household" placeholder="Your annual income">
                                    <br>
                                    <hr>
                                    <br>


                                    <label for="Property Managment Company">Property Managment Company</label>
                                    <input type="text" id="Property Managment Company" name="Property Managment Company">
                                    <br>
                                    <label for="Phone">Phone</label>
                                    <input type="text" id="Phone" name="Phone">
                                    <br>
                                    <label for="Website">Website</label>
                                    <input type="text" id="Website" name="Website">
                                    <br>
                                    <label for="Longitude">Longitude</label>
                                    <input type="text" id="Longitude" name="Longitude">
                                    <br>
                                    <label for="Latitude">Latitude</label>
                                    <input type="text" id="Latitude" name="Latitude">
                                    <br>
                                    <label for="Location">Location</label>
                                    <input type="text" id="Location" name="Location">
                                    <br>

                                    <br>
                                    <hr>
                                    <br></br>
                                    <button class="example_b" type="button" onclick="validateForm()">SUBMIT</button>

                                </center>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>






</body>



<script>
    function validateForm() {
      
      var projectName = document.forms["myForm"]["projectName"].value;
      if (projectName == "") {
        alert("project Name must be filled out");
        return false;
      }
      var address = document.forms["myForm"]["address"].value;
      if (address == "") {
        alert("address must be filled out");
        return false;
      }
      var zip = parseInt(document.forms["myForm"]["zip"].value);
      if (zip == "") {
        alert("zip must be filled out");
        return false;
      }
      var totalUnits = parseInt(document.forms["myForm"]["totalUnits"].value);
      if (totalUnits == "") {
        alert("totalUnits must be filled out");
        return false;
      }
      var affordableUnits = parseInt(document.forms["myForm"]["affordableUnits"].value);
      if (affordableUnits == "") {
        alert("affordableUnits must be filled out");
        return false;
      }

      var unitType = document.forms["myForm"]["unitType"].value;

      if (unitType == "") {
        alert("unit Type must be filled out");
        return false;
      }

      var housingType = document.forms["myForm"]["housingType"].value;

      if (housingType == "") {
        alert("housing type must be filled out");
        return false;
      }
      var status = document.forms["myForm"]["status"].value;

      var onePersonHousehold = parseInt(document.forms["myForm"]["1 Person Household"].value);
      if (onePersonHousehold == "") {
        alert("1 Person Household must be filled out");
        return false;
      }
      var twoPersonHousehold = parseInt(document.forms["myForm"]["2 Person Household"].value);
      if (twoPersonHousehold == "") {
        alert("2 Person Household must be filled out");
        return false;
      }
      var threePersonHousehold = parseInt(document.forms["myForm"]["3 Person Household"].value);
      if (threePersonHousehold == "") {
        alert("3 Person Household must be filled out");
        return false;
      }
      var fourPersonHousehold = parseInt(document.forms["myForm"]["4 Person Household"].value);
      if (fourPersonHousehold == "") {
        alert("4 Person Household must be filled out");
        return false;
      }
      var fivePersonHousehold = parseInt(document.forms["myForm"]["5 Person Household"].value);
      if (fivePersonHousehold == "") {
        alert("5 Person Household must be filled out");
        return false;
      }
      var propertyManagmentCompany = document.forms["myForm"]["Property Managment Company"].value;

      var Phone = document.forms["myForm"]["Phone"].value;

      var Website = document.forms["myForm"]["Website"].value;

      var Longitude = parseFloat(document.forms["myForm"]["Longitude"].value);

      if (Longitude == "") {
        alert("Longitude must be filled out");
        return false;
      }
      var Latitude = parseFloat(document.forms["myForm"]["Latitude"].value);

      if (Latitude == "") {
        alert("Latitude must be filled out");
        return false;
      }
      var Location = document.forms["myForm"]["Location"].value;

      if (Location == "") {
        alert("Location must be filled out");
        return false;
      }
  
 



      var housingDictionary = {
        "Project Name": projectName,
        "Address": address,
        "Zip Code": zip,
        "Total Units": totalUnits,
        "Total Affordable Units": affordableUnits,
        "Unit Type": unitType,
        "Housing Type": housingType,
        "Status":status,
        "1 Person Household": onePersonHousehold,
        "2 Person Household": twoPersonHousehold,
        "3 Person Household": threePersonHousehold,
        "4 Person Household": fourPersonHousehold,
        "5 Person Household": fivePersonHousehold,
        "Property Management Company": propertyManagmentCompany,
        "Phone": Phone,
        "Website": Website,
        "Longitude": Longitude,
        "Latitude": Latitude,
        "Location": Location
      };
      sendNewProperty(housingDictionary);
      return false;

    }

    function sendNewProperty(housingDictionary) {

      var url = '/api/housingAdd';

      var jsonObject = JSON.stringify(housingDictionary)

      console.log(jsonObject);

      //making a bridge to the web server
      var request = new XMLHttpRequest();
      //initializing request to the web server
      request.open('POST', url, true);
      //Setting the header of the API request
      request.setRequestHeader("Content-type", "application/json");

      //do something with the data being processed

      request.onload = function () {
        console.log("request.onload is called!");

        // Good response
        if (request.status >= 200 && request.status < 400) {
          console.log("Request is sent!");
          console.log("Response: " + request.status);
          console.log(request.statusText);
          if(request.statusText == "OK"){
            //sessionStorage.setItem("response",request.response);
            alert("new housing is uploaded successfully.");
            location.replace("http://67.205.136.114/adminDash.html");
          }else {
            alert("There is error, please try again later");
          }

        }

        else {
          //Error handling
          const errorMessage = document.createElement('error');
          errorMessage.textContent = "Connection Error!";
          alert(request.status + " FAILED: Housing data" + housingDictionary['projectName'] + " failed (" + request.response + ")");
          console.log(request.status);
        }
      }

      //request get sent out
      request.send(jsonObject);
    }

  </script>






</html>
